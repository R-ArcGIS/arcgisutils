<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Developer oriented utility functions designed to be used as
    the building blocks of R packages that work with ArcGIS Location
    Services. It provides functionality for authorization, Esri JSON
    construction and parsing, as well as other utilities pertaining to
    geometry and Esri type conversions. To support ArcGIS Pro users,
    authorization can be done via arcgisbinding. Installation
    instructions for arcgisbinding can be found at
    &lt;https://r.esri.com/r-bridge-site/arcgisbinding/installing-arcgisbinding.html&gt;.">
<title>ArcGIS Utility Functions • arcgisutils</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="ArcGIS Utility Functions">
<meta property="og:description" content="Developer oriented utility functions designed to be used as
    the building blocks of R packages that work with ArcGIS Location
    Services. It provides functionality for authorization, Esri JSON
    construction and parsing, as well as other utilities pertaining to
    geometry and Esri type conversions. To support ArcGIS Pro users,
    authorization can be done via arcgisbinding. Installation
    instructions for arcgisbinding can be found at
    &lt;https://r.esri.com/r-bridge-site/arcgisbinding/installing-arcgisbinding.html&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">arcgisutils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/R-ArcGIS/arcgisutils/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="arcgisutils">arcgisutils<a class="anchor" aria-label="anchor" href="#arcgisutils"></a>
</h1></div>
<p>arcgisutils is a developer oriented package that provides the basic functions to build R packages that work with ArcGIS Location Services. It provides functionality for authorization, Esri JSON construction and parsing, as well as other utilities pertaining to geometry and Esri type conversions.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of arcgisutils from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"R-ArcGIS/arcgisutils"</span><span class="op">)</span></span></code></pre></div>
<p>arcgisutils is designed as the backbone of the package <a href="https://github.com/r-arcgis/arcgislayers" class="external-link"><code>{arcgislayers}</code></a> and other planned location services packages.</p>
<div class="section level3">
<h3 id="authorization">Authorization<a class="anchor" aria-label="anchor" href="#authorization"></a>
</h3>
<p>Authorization tokens are provided through the functions <code><a href="reference/auth.html">auth_code()</a></code>, <code><a href="reference/auth.html">auth_client()</a></code>, <code><a href="reference/auth.html">auth_user()</a></code>, and <code><a href="reference/auth.html">auth_binding()</a></code>. Additional token validation functions are provided via <code><a href="reference/auth.html">refresh_token()</a></code> and <code><a href="reference/auth.html">validate_or_refresh_token()</a></code>.</p>
<p>Tokens are managed in a session based cache using <code><a href="reference/token.html">set_arc_token()</a></code> and <code><a href="reference/token.html">unset_arc_token()</a></code>. They are fetched using <code><a href="reference/token.html">arc_token()</a></code>. Here is a minimal example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-ArcGIS/arcgisutils" class="external-link">arcgisutils</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">tkn</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/auth.html">auth_client</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/token.html">set_arc_token</a></span><span class="op">(</span><span class="va">tkn</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/token.html">arc_token</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;httr2_token&gt;</span></span>
<span><span class="co">#&gt; token_type: bearer</span></span>
<span><span class="co">#&gt; access_token: &lt;REDACTED&gt;</span></span>
<span><span class="co">#&gt; expires_at: 2024-02-23 10:56:42</span></span>
<span><span class="co">#&gt; arcgis_host: https://www.arcgis.com</span></span></code></pre></div>
<p>Alternatively, tokens can be set based on a key-value pair.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/token.html">set_arc_token</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="va">tkn</span>, <span class="st">"B"</span> <span class="op">=</span> <span class="va">tkn</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Named tokens set: `A` and `B`</span></span>
<span><span class="co">#&gt; ℹ Access named tokens with `arc_token("name")`</span></span></code></pre></div>
<p>And fetched based on their name via</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/token.html">arc_token</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;httr2_token&gt;</span></span>
<span><span class="co">#&gt; token_type: bearer</span></span>
<span><span class="co">#&gt; access_token: &lt;REDACTED&gt;</span></span>
<span><span class="co">#&gt; expires_at: 2024-02-23 10:56:42</span></span>
<span><span class="co">#&gt; arcgis_host: https://www.arcgis.com</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="standardized-requests">Standardized Requests<a class="anchor" aria-label="anchor" href="#standardized-requests"></a>
</h3>
<p>The function <code><a href="reference/arc_base_req.html">arc_base_req()</a></code> is used to create a standardized <code>httr2</code> request object. It handles authorization tokens and sets a user agent.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">host</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/arc_host.html">arc_host</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># use arcgis.com by default</span></span>
<span></span>
<span><span class="fu"><a href="reference/arc_base_req.html">arc_base_req</a></span><span class="op">(</span><span class="va">host</span><span class="op">)</span> </span>
<span><span class="co">#&gt; &lt;httr2_request&gt;</span></span>
<span><span class="co">#&gt; GET https://www.arcgis.com</span></span>
<span><span class="co">#&gt; Body: empty</span></span>
<span><span class="co">#&gt; Options:</span></span>
<span><span class="co">#&gt; • useragent: 'arcgisutils v0.2.0'</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="esri-json">Esri JSON<a class="anchor" aria-label="anchor" href="#esri-json"></a>
</h3>
<p>There are also a number of utility functions for creating and parsing Esri JSON. For example we can create a list that represent an Esri <code>FeatureSet</code> using <code>as_featurset()</code> directly from an <code>sf</code> object. To convert to json, it is recommended to use <code>jsonify::to_json(x, unbox = TRUE)</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'sf' was built under R version 4.3.1</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE</span></span>
<span></span>
<span><span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shape/nc.shp"</span>, package <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">nc_json</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/esri_geometry.html">as_featureset</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">nc_json</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ geometryType    : chr "esriGeometryPolygon"</span></span>
<span><span class="co">#&gt;  $ spatialReference:List of 1</span></span>
<span><span class="co">#&gt;  $ hasZ            : logi FALSE</span></span>
<span><span class="co">#&gt;  $ hasM            : logi FALSE</span></span>
<span><span class="co">#&gt;  $ features        :List of 100</span></span></code></pre></div>
<p>Alternatively, you can use the set of functions with the <code>_esri_</code> infix to directly create the json. See the <a href="https://r.esri.com/arcgisutils/reference/esri_geometry.html" class="external-link">Esri geometry reference page</a> for more on how the conversion functions work.</p>
<p>Additionally, sf’s <code>crs</code> object can be converted to a <a href="https://developers.arcgis.com/documentation/common-data-types/geometry-objects.htm#GUID-DFF0E738-5A42-40BC-A811-ACCB5814BABC" class="external-link"><code>spatialReference</code></a> JSON object using <code><a href="reference/validate_crs.html">validate_crs()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/validate_crs.html">validate_crs</a></span><span class="op">(</span><span class="fl">27700</span><span class="op">)</span></span>
<span><span class="co">#&gt; $spatialReference</span></span>
<span><span class="co">#&gt; $spatialReference$wkid</span></span>
<span><span class="co">#&gt; [1] 27700</span></span></code></pre></div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=arcgisutils" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/R-ArcGIS/arcgisutils/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/R-ArcGIS/arcgisutils/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>Apache License (&gt;= 2)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing arcgisutils</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Josiah Parry <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-9910-865X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/R-ArcGIS/arcgisutils/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/R-ArcGIS/arcgisutils/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://CRAN.R-project.org/package=arcgisutils" class="external-link"><img src="https://www.r-pkg.org/badges/version/arcgisutils" alt="CRAN status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Josiah Parry.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
